$('.right-list').html(' #{j(render(partial: 'new'))} ')
$(".top-options").html(' #{j(render(partial: 'new_options'))} ')


$(".new-form").on("change",".subject-id",function(){
if($(this).val() == 'other'){
$(".subject-field").removeClass("hide")
}
else{
$(".subject-field").addClass("hide")
$(".new-subject-text").val("")
}      
})


$(".new-form").on("keyup",".tag-field",function(){
_this = this
$(".tag-list").html("")
if($(this).val().length > 0){
$(".tag-list-div").removeClass("hide")
value = $(this).val()
$.ajax({
url: "/topics/search",
data: {search:value},
success: function(data){
if(data.topics.length > 0){
$.each(data.topics,function(index,value){
$(".tag-list").append("<a class= 'tag-title' href = '#'><li>"+value.title+"</li></a>")
})
}
else{
$(".tag-list").html("")
$(".tag-list").append("No Result found. Create new topic by pressing enter")
}
}
})
}
else{
$(".tag-list-div").addClass("hide")
}
})


$(".new-form").on("click",".tag-title",function(e){
e.preventDefault()
$(".tag-list-div").addClass("hide")
value = $(this).children("li").html()
$(".tag-field").val(value)
$(".tag-badges-list").removeClass("hide")
$(".tag-badges-list").append("<span class = 'badge my-badge'>"+value+"</span>")
value = value + ","+ $("#submit_tag").val()
$("#submit_tag").val(value) 
})

$(".top-options").on("click",".create-quiz-bank",function(e){
e.preventDefault()
$("form").submit()
})



$("#quiz_form").validate({
onkeyup: false,
onclick: false,
onfocusout: false,
rules: {
"quiz_bank[title]": {
required: true,
minlength: 5,
maxlength: 50
},
"quiz_bank[description]": {
required: true
},
"quiz_bank[repository_id]":{
required: true
}
},
messages: {
"quiz_bank[title]": {
required: "Please enter title",
minlength: "Please enter minimum 5 characters",
maxlength: "Please enter maximum 50 characters"
},

"quiz_bank[description]": {
required: "Please enter description"
},
"quiz_bank[repository_id]":{
required: "Please enter repository"
}
},
highlight: function(element) {
$(element).siblings('label.error').remove();
$(element).closest('.control_validate').removeClass('success').addClass('error');
},
// Success function accepts lable as an argument
success: function(element) {
$(element).remove();
$(element).closest('.control_validate').removeClass('error').addClass('success');
}
});
