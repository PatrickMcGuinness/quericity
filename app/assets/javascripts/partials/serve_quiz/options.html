<div ng-include src="'/assets/partials/common/menu.html'"></div>
<div class="row_bottom">
  <div class="container">
    <div class="sub_nav">
      <span class="sub_nav_icon"><img src="/assets/serve_new_quiz_icon.png" /></span>
      <span class="sub_nav_link"><a href="#/serve_quiz/new" data-toggle = "tooltip" title = "Serve new Quiz" tooltip-placement = "top">Serve Quiz</a></span>
    </div>
    <div class="sub_nav">
      <span class="sub_nav_icon"><img src="/assets/student_group.png" /></span>
      <span class="sub_nav_link"><a href="#/groups" data-toggle = "tooltip" title = "List Student Groups" tooltip-placement = "top">Student Groups</a></span>
    </div>
    <div class="sub_nav">
      <span class="sub_nav_icon"><img src="/assets/add_group.png" /></span>
      <span class="sub_nav_link"><a href="#/groups/new" data-toggle = "tooltip" title = "Add new Group" tooltip-placement = "top">Add Group</a></span>
    </div>
     
  </div>
</div>
<div class="container">
	<div class="row" ng-show = "show_options">
    <form name="OptionForm" ng-submit="checkOptions(OptionForm.$valid)" novalidate>
    	<div class="col-xs-12">
      	<div class="row">
          <div class = "col-xs-12"> 
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.title.$invalid) && (!OptionForm.title.$pristine || option_submitted == true)}">
              <select class="form-control form_section" ng-model="selected_quiz" ng-options="quiz_bank as quiz_bank.title for quiz_bank in quiz_banks" name = "title" required>
                <option value = "">Select Quiz</option>
              </select>
              <p ng-show="OptionForm.title.$invalid && (!OptionForm.title.$pristine || option_submitted == true)" class="help-block">Required!</p>
            </div>  
          </div> 
  	    </div>
        <div class="row">
          <div class="col-xs-2 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.date.$invalid) && (!OptionForm.date.$pristine || option_submitted == true)}">
          	 <span class="label_text">Start Date:</span>
              <span>
                <div class="row" ng-controller = "DatePickerCtrl">
                  <div class="col-xs-12">
                    <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.date.$invalid) && (!OptionForm.date.$pristine || option_submitted == true)}">
                      <p class="input-group">
                        <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="quiz.date" is-open="opened" min="minDate"  datepicker-options="dateOptions"  required close-text="Close" name = "date"/>
                        <span class="input-group-btn">
                          <button class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>
                      </p>
                       <p ng-show="OptionForm.date.$invalid && (!OptionForm.date.$pristine || option_submitted == true)" class="help-block">Required!</p>
                    </div>   
                  </div>
                </div>
              </span>
            </div>  
          </div>
          <div class="col-xs-2 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.start_time.$invalid) && (!OptionForm.start_time.$pristine || option_submitted == true)}">
            	<span class="label_text">Start Time:</span>
              <p class="input-group">
                <input type = "text" id="timepicker1" class = "form-control" timepick ng-model = "served_quiz.start_time" required name = "start_time"/>
                <span class="input-group-btn">
                  <button class="btn btn-default"><i class="glyphicon glyphicon-time"></i></button>
                </span>
              </p>
              <p ng-show="OptionForm.start_time.$invalid && (!OptionForm.start_time.$pristine || option_submitted == true)" class="help-block">Required!</p>
            </div>  
          </div>
          <div class="col-xs-2 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.close_date.$invalid) && (!OptionForm.close_date.$pristine || option_submitted == true)}">
            	<span class="label_text">End Date:</span>
              <span>
                <div class="row" ng-controller = "DatePickerCtrl">
                  <div class="col-xs-12">
                    <p class="input-group">
                      <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="quiz.close_date" is-open="opened" min="minDate"  datepicker-options="dateOptions"  required close-text="Close" name = "close_date"/>
                      <span class="input-group-btn">
                        <button class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                    </p>
                    <p ng-show="OptionForm.close_date.$invalid && (!OptionForm.close_date.$pristine || option_submitted == true)" class="help-block">Required!</p>
                  </div>
                </div>
              </span>
            </div>  
          </div>
          <div class="col-xs-2 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.end_time.$invalid) && (!OptionForm.end_time.$pristine || option_submitted == true)}">
            	<span class="label_text">End Time:</span>
              <span class="input-group">
                <input type = "text" class = "form-control" timepick ng-model = "served_quiz.end_time" required name = "end_time"/>
                <span class="input-group-btn">
                  <button class="btn btn-default"><i class="glyphicon glyphicon-time"></i></button>
                </span>
              </span>
              <p ng-show="OptionForm.end_time.$invalid && (!OptionForm.end_time.$pristine || option_submitted == true)" class="help-block">Required!</p>
            </div>  
          </div>
        </div>
        <div class="row">
          <div class="col-xs-2 radio_contorl form_section">
            <div class = "form-group">
              <input type="radio" name="time-limit" value = "0" ng-model = "served_quiz.infinite_duration">&nbsp;&nbsp;Time Limit:
            </div>  
          </div>
          <div class="col-xs-2 form_section ">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.duration.$invalid) && (!OptionForm.duration.$pristine || option_submitted == true) || (OptionForm.duration.$error.min)}">
              <span>
                <input type="number" class="label_field col-xs-12" ng-model = "served_quiz.duration" name = "duration" ng-disabled = "served_quiz.infinite_duration == 1" min = "1" style = "height: 38px;" ng-required = "served_quiz.infinite_duration == 0"/>
              </span>
              <p ng-show="(OptionForm.duration.$invalid) && (!OptionForm.duration.$pristine || option_submitted == true)" class="help-block">Required!</p>
              <p ng-show="OptionForm.duration.$error.min" class="help-block">Cannot pe less then 1.</p>
            </div> 
          </div>
          <div class="col-xs-3">
            <select class="form-control form_section" ng-disabled = "served_quiz.infinite_duration == 1">
              <option>Minutes</option>
            </select>
          </div>
          <span class="form_section">&nbsp;&nbsp;&nbsp;or</span>
          <div class="col-xs-2 radio_contorl form_section">
            <div class = "form-group">
              <input type="radio" name="time-limit" value= "1" ng-model = "served_quiz.infinite_duration">&nbsp;&nbsp;Unlimited Time
            </div>   
          </div>
          <div class = "col-xs-12">
            <p ng-show="served_quiz.infinite_duration == undefined" class="help-block" style = "color: #A94442;">Select one time option</p>
          </div>
        </div>
        <div class="row line_bg">
        </div>
        <div class="row">
  	      <span class="form_section col-xs-12">Question Per Page:</span>
        </div>
        <div class="row">
          <div class="col-xs-3 radio_contorl form_section">
            <input type="radio" name="questions_per_page" value = "1" ng-model = "served_quiz.show_all_questions">&nbsp;&nbsp;All Questions on one page 
          </div>
          <div class="col-xs-0 radio_contorl form_section">
            <input type="radio" name="questions_per_page" value = "0" ng-model = "served_quiz.show_all_questions"> 
          </div>
          <div class="col-xs-2 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.questions_per_page.$invalid) && (!OptionForm.questions_per_page.$pristine || option_submitted == true) || (OptionForm.questions_per_page.$error.min) || (OptionForm.questions_per_page.$error.max)}">
              <span>
                <input type="number" class="label_field col-xs-12" ng-model ="served_quiz.questions_per_page" name = "questions_per_page" ng-disabled = "served_quiz.show_all_questions == 1" min = "1" max = "{{quiz_bank_questions.length}}" style = "height:38px;" ng-required = "served_quiz.show_all_questions == 0"/>
              </span>
              <p ng-show="(OptionForm.questions_per_page.$invalid) && (!OptionForm.questions_per_page.$pristine || option_submitted == true)" class="help-block">Required!</p>
              <p ng-show="OptionForm.questions_per_page.$error.min" class="help-block">Cannot pe less then 1.</p>
              <p ng-show="OptionForm.questions_per_page.$error.max" class="help-block">Cannot be greater then total number of questions.</p>
            </div>  
          </div>
          <div class="col-xs-3">
            <span class="form_section">Question Per Page:</span>
          </div>
          <div class = "col-xs-12">
            <p ng-show="served_quiz.show_all_questions == undefined" class="help-block" style = "color: #A94442;">Select one layout option</p>
          </div>
        </div>
        <div class="row line_bg"></div>
        <div class="row">
          <div class="col-xs-2 form_section">
            <span>Instructions</span>
          </div>
          <div class="col-xs-9 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.instructions.$invalid) && (!OptionForm.instructions.$pristine || option_submitted == true)}">
              <span>
                <textarea type="text" placeholder="Quiz Instructions" class="label_field form-control" ng-model = "served_quiz.instructions" name = "instructions" required>
                </textarea>
              </span>
              <p ng-show="OptionForm.instructions.$invalid && (!OptionForm.instructions.$pristine || option_submitted == true)" class="help-block">Required!</p>
            </div>  
          </div>
          <div class="col-xs-2 form_section">
            <span>Show Answers:</span>
          </div>
          <div class="col-xs-9 form_section">
            <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.answer.$invalid) && (!OptionForm.answer.$pristine || option_submitted == true)}">
              <select class="form-control" ng-model = "served_quiz.answer" required name = "answer">
                <option value = "">When to show answers</option>
                <option value = "2">After Quiz</option>
                <option value = "3">Dont Show Answers</option>
              </select>
              <p ng-show="OptionForm.answer.$invalid && (!OptionForm.answer.$pristine || option_submitted == true)" class="help-block">Required!</p>
            </div>  
          </div>
        </div>
        <div class="row">
          <div class="col-xs-4 form_section">
            <span>
              <input type="radio" name="question-option" value = "0" checked ng-click = "show_question_list = true" ng-model = "served_quiz.random">
            </span>
            <span style = "margin-left:10px">Select from questions list</span>
          </div>  
          <span class="form_section">
            <input type="radio" name="question-option" value = "1" ng-click = "show_question_list = false" ng-model = "served_quiz.random">
          </span>
          <div class="col-xs-4 form_section">
            <span>Randomize the questions</span>
          </div>
          <div class = "col-xs-12">
            <p ng-show="served_quiz.random == undefined" class="help-block" style = "color: #A94442;">Select one question selection option</p>
          </div>
        </div>
        <div class="row" ng-show = "show_question_list">
        	<div class="col-xs-12">
            <div class="col-xs-12 strip form_section" ng-repeat = "question in quiz_bank_questions">
              <div class="col-xs-0 pull-left">
                <input type="checkbox" name="checkbox" value = "{{question.id}}" ng-click = "select_question(question)"/>
              </div>
              <div class="col-xs-10 ">
                <span style="float:left; margin-left:10px;" ng-bind-html="question.description | unsafe"></span>
  			      </div>
            </div>
          </div>
        </div>
        <div class="row" ng-hide = "show_question_list">
          <div class="col-xs-12">
            <div class="col-xs-12 strip form_section ">
              <div class = "form-group" ng-class="{ 'has-error' : (OptionForm.number_of_questions.$invalid) && (!OptionForm.number_of_questions.$pristine || option_submitted == true) || (OptionForm.number_of_questions.$error.min) || (OptionForm.number_of_questions.$error.max)}">
                <div class="col-xs-2 ">
                  <span style="float:left;">Number of Questions:</span>
                </div>
                <div class="col-xs-1">
                  <span>
                    <input type="number" class="label_field col-xs-12" ng-model = "served_quiz.number_of_questions" name = "number_of_questions" min = "1" max = "{{quiz_bank_questions.length}}" style = "height:38px;" ng-required = "served_quiz.random == 1"/>
                  </span> 
                </div>
                <div class="col-xs-2 ">
                  <span style="float:left; margin-left:10px;">/{{quiz_bank_questions.length}}</span>
                </div>
                <div class = "col-xs-12">
                  <p ng-show="(OptionForm.number_of_questions.$invalid) && (!OptionForm.number_of_questions.$pristine || option_submitted == true)" class="help-block">Required!</p>
                  <p ng-show="OptionForm.number_of_questions.$error.min" class="help-block">Cannot pe less then 1.</p>
                  <p ng-show="OptionForm.number_of_questions.$error.max" class="help-block">Cannot be greater then total number of questions.</p>
                </div>  
              </div>  
            </div>
            <!--<div class="col-xs-12 strip">
              <div class="col-xs-0 pull-left">
                <input type="checkbox" name="checkbox" />
              </div>
              <div class="col-xs-6 ">
                <span style="float:left; margin-left:10px;">Same questions for students</span>
              </div>
            </div>
            <div class="col-xs-12 strip">
              <div class="col-xs-0 pull-left">
                <input type="checkbox" name="checkbox" />
              </div>
              <div class="col-xs-6 ">
                <span style="float:left; margin-left:10px;">Same questions in same sequence</span>
              </div>
            </div> -->
          </div>
        </div>
        <div class = "row">
          <div class = "col-xs-12 mar-top-20">
            <div class = "col-xs-1 pull-right">  
              <button type="submit" class="btn btn_blue" data-toggle = "tooltip" title = "Go to Select Student Step" tooltip-placement = "top">Next</button>
            </div>
            <div class = "col-xs-1 pull-right">
              <button type="button" class="btn" data-toggle = "tooltip" title = "Preview the quiz" tooltip-placement = "top">Preview</button>
            </div>
          </div>
        </div>
  		</div>
    </form>
	</div>
  <div class="row" ng-hide = "show_options">
    <div class="col-xs-12">
      <!--<div class="row">
        <div class="col-xs-3 btn_section">
          <button type="button" class="btn btn_grey" ng-click = "show_options = true" data-toggle = "tooltip" title = "Select Quiz Options" tooltip-placement = "top">Options</button>
          <button type="button" class="btn btn_blue" ng-click = "show_options = false" data-toggle = "tooltip" title = "Select Students to Serve" tooltip-placement = "top">Select Students</button>
        </div>
      </div> -->
      <div class="row">
        <div class="col-xs-5 left_section_area">
          <input type="text" ng-model="student" typeahead="student as student.first_name for student in system_students | filter:{first_name:$viewValue} | limitTo:8" class="form-control" enter = "AddStudent(student)" placeholder="Search by name" typeahead-on-select = "AddStudent(student)">
          <select class="form-control form_section col-xs-12" ng-model="selected_group" ng-options="group as group.title for group in groups">
            <option value = "">Select Group</option>
          </select>  
          <ul class="col-xs-12">
            <li class="col-xs-11 select_section" ng-repeat = "group_student in group_students" style = "word-wrap: break-word;">
              <span class="col-xs-4"><img src="{{group_student.profile_pic.url}}" class="img-thumbnail" /></span>
              <span style=" float:right;"><input type="checkbox" name="checkbox" ng-click = "student_to_right(group_student)"/></span>
              <span class="col-xs-6"><h4>{{group_student.first_name}}{{group_student.last_name}}</h4>
              <p>{{group_student.email}}</p></span>
            </li>
          </ul>
        </div>
        <div class="col-xs-2">
          <div class="row top200">
            <span class="col-xs-4 col-xs-offset-3 arrow_left">
              <a ng-click="move_to_left()" data-toggle = "tooltip" title = "Deselect all Students" tooltip-placement = "top"><img src="/assets/big_arrow_left.png"/></a>
            </span>
            <span class="col-xs-4 arrow_right">
              <a ng-click="move_to_right()" data-toggle = "tooltip" title = "Select all Students" tooltip-placement = "top"><img src="/assets/big_arrow_right.png" /></a>
            </span>
          </div>
        </div>
        <div class="col-xs-5 right_section_area">
          <ul class="col-xs-12">
            <li class="col-xs-11 select_section" ng-repeat = "selected_student in selected_students" style = "word-wrap: break-word;">
              <span class="col-xs-4"><img src="{{selected_student.profile_pic.url}}" class="img-thumbnail" /></span>
              <span style=" float:right;"><input type="checkbox" name="checkbox" ng-click= "student_to_left(selected_student)"/></span>
              <span class="col-xs-6"><h4>{{selected_student.first_name}}{{selected_student.last_name}}</h4>
              <p>{{selected_student.email}}</p></span>
            </li>
          </ul>
        </div>
      </div>
      <div class = "row">
        <div class = "col-xs-12 mar-top-20">
          <div class = "col-xs-1 pull-right">  
            <a type="button" class="btn btn_blue" ng-click = "serveTheQuiz()" ng-href ="#/served_quizzes" data-toggle = "tooltip" title = "Serve The Quiz" tooltip-placement = "top">Serve</a>
          </div>
          <div class = "col-xs-1 pull-right">
            <button type="button" class="btn" data-toggle = "tooltip" title = "Preview the Quiz" tooltip-placement = "top">Preview</button>
          </div>
          <div class = "col-xs-1 pull-right">
            <button type="button" class="btn" ng-click = "show_options = true" data-toggle = "tooltip" title = "Go to Select Option Step" tooltip-placement = "top">Previous</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  


